<template>
  <div>
    <Popover class="sticky top-0 z-50 w-full bg-white dark:bg-dark-bg border-b-2 border-gray-100 dark:border-gray-500 ">
      <div class="max-w-8xl mx-auto px-4 sm:px-1">
        <div
          class="flex justify-between items-center py-3 pl-0 sm:pl-3 md:pl-3 md:justify-start md:space-x-10">
          <div class="flex justify-left md:flex-1 lg:w-0 lg:flex-1">
            <NuxtLink to="/">
              <span class="sr-only">Workflow</span>
              <svg class=" w-12 h-12 md:w-14 md:h-14 " viewBox="0 0 55 55" version="1.1"
                xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                <title>SAF SVG - blue</title>
                <desc>Created with Sketch.</desc>
                <g id="SAF-SVG---blue" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                  <g id="noun_Shield_2736744" transform="translate(5.200000, 0.000000)" fill="#1a73e8"
                    fill-rule="nonzero">
                    <path
                      d="M3.38103757,8.21109123 C3.67084079,12.0751342 0,14.1037567 0,14.1037567 C0,14.1037567 2.12522361,18.6440072 2.12522361,26.9516995 C2.12522361,35.2593918 4.54025045,40.9588551 9.27370304,45.2093023 C14.0071556,49.4597496 22.3148479,54 22.3148479,54 C22.3148479,54 30.6225403,49.4597496 35.2593918,45.2093023 C39.9928444,40.9588551 42.5044723,35.2593918 42.5044723,26.9516995 C42.5044723,18.6440072 44.6296959,14.1037567 44.6296959,14.1037567 C44.6296959,14.1037567 40.9588551,12.0751342 41.2486583,8.21109123 C41.2486583,8.21109123 37.3846154,7.82468694 32.3613596,5.98926655 C26.372093,3.76744186 22.3148479,0 22.3148479,0 C22.3148479,0 18.1610018,3.76744186 12.1717352,5.98926655 C7.14847943,7.82468694 3.38103757,8.21109123 3.38103757,8.21109123 Z M22.3148479,51.8747764 C20.0930233,50.5223614 14.1037567,47.0447227 10.529517,43.8568873 C6.08586762,39.7996422 3.96064401,34.3899821 3.96064401,26.9516995 C3.96064401,20.9624329 2.8980322,16.8085868 2.22182469,14.7799642 C3.28443649,13.8139535 4.73345259,12.1717352 5.11985689,9.85330948 C6.76207513,9.46690519 9.56350626,8.88729875 12.8479428,7.72808587 C17.1949911,6.18246869 20.5760286,3.76744186 22.3148479,2.41502683 C24.0536673,3.76744186 27.4347048,6.18246869 31.6851521,7.72808587 C34.9695886,8.88729875 37.7710197,9.46690519 39.4132379,9.85330948 C39.7996422,12.1717352 41.2486583,13.8139535 42.3112701,14.7799642 C41.6350626,16.8085868 40.5724508,20.9624329 40.5724508,26.9516995 C40.5724508,34.3899821 38.5438283,39.7996422 34.0035778,43.8568873 C30.4293381,47.0447227 24.5366726,50.5223614 22.3148479,51.8747764 Z M22.3148479,50.5223614 C24.8264758,49.0733453 30.0429338,45.8855098 33.2307692,42.9874776 C37.4812165,39.1234347 39.509839,34.1001789 39.509839,26.9516995 C39.509839,21.4454383 40.3792487,17.3881932 41.0554562,15.1663685 C40.0894454,14.1037567 38.9302326,12.6547406 38.4472272,10.7227191 C36.7084079,10.4329159 34.19678,9.85330948 31.3953488,8.79069767 C27.3381038,7.34168157 24.1502683,5.21645796 22.3148479,3.86404293 L22.3148479,3.86404293 L22.3148479,50.5223614 C22.3148479,50.5223614 22.3148479,50.5223614 22.3148479,50.5223614 L22.3148479,50.5223614 Z"
                      id="Shape"></path>
                  </g>
                  <g id="Group" transform="translate(14.500000, 14.000000)" fill-rule="nonzero">
                    <g id="noun_Gear_31895" fill="#1a73e8">
                      <path
                        d="M13,0 L11.375,0 L10.7894414,3.51025391 C9.73573047,3.75623828 8.74864453,4.17360937 7.85525,4.72900391 L4.95594531,2.65966797 L2.65809375,4.95751953 L4.72900391,7.85525 C4.17198437,8.74712109 3.75623828,9.73415625 3.51182812,10.7894414 L0,11.375 L0,14.625 L3.51182812,15.2105586 C3.75623828,16.2658437 4.17198437,17.2513555 4.72900391,18.14475 L2.65809375,21.0440547 L4.95594531,23.3419063 L7.85682422,21.2709961 C8.74869531,21.8280156 9.73573047,22.2437617 10.7894414,22.4881719 L11.375,26 L13,26 L13,0 Z M13,19.5 C9.410375,19.5 6.5,16.5895742 6.5,13 C6.5,9.41042578 9.41042578,6.5 13,6.5"
                        id="Shape"></path>
                    </g>
                    <g id="noun_Gear_31895" transform="translate(10.000000, 0.000000)" fill="#FFFFFF">
                      <path
                        d="M16,14.625 L16,11.375 L12.4881719,10.7894414 C12.2437617,9.73415625 11.8280156,8.74864453 11.2709961,7.85525 L13.3419063,4.95751953 L11.0440547,2.65966797 L8.14475,4.72900391 C7.25130469,4.17355859 6.26584375,3.75623828 5.21055859,3.51025391 L4.625,0 L3,0 L3,26 L4.625,26 L5.21055859,22.4881719 C6.26426953,22.2437617 7.25135547,21.8280156 8.14475,21.2709961 L11.0440547,23.3419063 L13.3419063,21.0440547 L11.2709961,18.14475 C11.8280156,17.2513047 12.2437617,16.2642695 12.4881719,15.2105586 L16,14.625 Z M3,6.5 C6.58957422,6.5 9.5,9.41042578 9.5,13 C9.5,16.5895742 6.589625,19.5 3,19.5 L3,19.5"
                        id="Shape"></path>
                    </g>
                  </g>
                </g>
              </svg>
            </NuxtLink>
            <NuxtLink to="/" class="flex">
              <h1
                class="text-2xl tracking-tighter p-2 font-extrabold whitespace-nowrap text-gray-900 dark:text-MITRE-silver  md:text-3xl xl:text-4xl">
                <span class="block xl:inline">MITRE SAF</span> 
              </h1>
              <p class="mt-1 text-xs dark:text-dark-text">Â©</p>
            </NuxtLink>
          </div>

          <div id="mobile-components" class="-mr-2 -my-2 flex sm:pr-3 md:hidden">
            <div class="flex-1 flex justify-end px-2 lg:ml-6">
              <div class="max-w-lg w-1/8 lg:max-w-xs">
                <label for="search" class="sr-only">Search</label>
                <div class="relative">
                  <div class="absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none">
                    <SearchIcon class="h-5 w-5 text-gray-400" aria-hidden="true" />
                  </div>
                  <input id="search" name="search"
                    class="block w-0 focus:w-full pl-5 focus:pl-10 pr-4 py-3 border border-transparent rounded-md leading-5 bg-white dark:bg-dark-bg text-gray-300 placeholder-gray-400 focus:outline-none focus:bg-white dark:focus:bg-MITRE-light-silver focus:border-white dark:focus:border-dark-bg focus:ring-blue-400 dark:focus:ring-dark-bg focus:text-gray-900 sm:text-sm hover:bg-gray-200 dark:hover:bg-gray-700"
                    placeholder="Search" type="search" />
                </div>
              </div>
            </div>
            <PopoverButton
              class="bg-white dark:bg-dark-bg rounded-md p-2 inline-flex items-center justify-center text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500">
              <span class="sr-only">Open menu</span>
              <DotsVerticalIcon class="h-6 w-6 text-gray-400" aria-hidden="true" />
            </PopoverButton>
          </div>


          <PopoverGroup as="nav" class="hidden md:flex space-x-7 xl:space-x-10">
            <!-- TODO: Remove pointer-events-none and change 'text-red-500' to 'text-gray-500' in this button to reenable it -->
            <Popover class="relative" v-slot="{ open }">
              <PopoverButton :class="[
                open
                  ? 'text-gray-900 dark:text-gray-200'
                  : 'text-red-500 dark:text-dark-text',
                'group bg-white dark:bg-dark-bg rounded-md inline-flex items-center text-base font-medium hover:text-gray-900 dark:hover:text-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 pointer-events-none'
              ]">
                <span>Toolkit</span>
                <ChevronDownIcon :class="[
                  open ? 'text-gray-600' : 'text-gray-400 dark:text-dark-text',
                  'ml-2 h-5 w-5 group-hover:text-gray-500'
                ]" aria-hidden="true" />
              </PopoverButton>

              <transition enter-active-class="transition ease-out duration-200" enter-from-class="opacity-0 translate-y-1"
                enter-to-class="opacity-100 translate-y-0" leave-active-class="transition ease-in duration-150"
                leave-from-class="opacity-100 translate-y-0" leave-to-class="opacity-0 translate-y-1">
                <PopoverPanel
                  class="absolute z-10 -ml-4 mt-3 transform px-2 w-screen max-w-md sm:px-0 lg:ml-0 lg:left-1/2 lg:-translate-x-1/2">
                  <div class="rounded-lg shadow-lg ring-1 ring-black dark:ring-gray-500 ring-opacity-5 overflow-hidden">
                    <div class="relative grid gap-6 bg-white dark:bg-dark-bg px-5 py-6 sm:gap-8 sm:p-8">
                      <NuxtLink v-for="item in toolkit" :key="item.name" :to="item.href"
                        class="-m-3 p-3 flex items-start rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700">
                        <component :is="item.icon" class="flex-shrink-0 h-6 w-6 text-blue-600" aria-hidden="true" />
                        <div class="ml-4">
                          <p class="text-base font-medium text-gray-900 dark:text-MITRE-silver">
                            {{ item.name }}
                          </p>
                          <p class="mt-1 text-sm text-gray-500">
                            {{ item.description }}
                          </p>
                        </div>
                      </NuxtLink>
                    </div>
                    <div
                      class="px-5 py-5 bg-gray-50 dark:bg-dark-bg space-y-6 sm:flex sm:space-y-0 sm:space-x-10 sm:px-8">
                      <div v-for="item in callsToAction" :key="item.name" class="flow-root">
                        <a :href="item.href"
                          class="-m-3 p-3 flex items-center rounded-md text-base font-medium text-gray-900 dark:text-MITRE-silver hover:bg-gray-100">
                          <component :is="item.icon" class="flex-shrink-0 h-6 w-6 text-gray-400" aria-hidden="true" />
                          <span class="ml-3">{{ item.name }}</span>
                        </a>
                      </div>
                    </div>
                  </div>
                </PopoverPanel>
              </transition>
            </Popover>

            <NuxtLink to="/blog"
              class="text-base font-medium text-gray-500 dark:text-dark-text hover:text-gray-900 dark:hover:text-gray-200">
              Blog
            </NuxtLink>

            <NuxtLink to="/docs"
              class="text-base font-medium text-gray-500 dark:text-dark-text hover:text-gray-900 dark:hover:text-gray-200">
              Docs
            </NuxtLink>

            <!-- <NuxtLink to="/faq"
              class="text-base font-medium text-gray-500 dark:text-dark-text hover:text-gray-900 dark:hover:text-gray-200">
              FAQ
            </NuxtLink> -->
            
            <Popover class="relative" v-slot="{ open }">
              <PopoverButton :class="[
                open
                  ? 'text-gray-900 dark:text-gray-300'
                  : 'text-gray-500 dark:text-dark-text',
                'group bg-white dark:bg-dark-bg rounded-md inline-flex items-center text-base font-medium hover:text-gray-900 dark:hover:text-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500' 
              ]">
                <span>More</span>
                <ChevronDownIcon :class="[
                  open ? 'text-gray-600 ' : 'text-gray-400',
                  'ml-2 h-5 w-5 group-hover:text-gray-500'
                ]" aria-hidden="true" />
              </PopoverButton>

              <transition enter-active-class="transition ease-out duration-200" enter-from-class="opacity-0 translate-y-1"
                enter-to-class="opacity-100 translate-y-0" leave-active-class="transition ease-in duration-150"
                leave-from-class="opacity-100 translate-y-0" leave-to-class="opacity-0 translate-y-1">
                <PopoverPanel
                  class="absolute z-10 left-1/2 transform -translate-x-1/2 mt-3 px-2 w-screen max-w-md sm:px-0">
                  <div class="rounded-lg shadow-lg ring-1 ring-black dark:ring-gray-500 ring-opacity-5 overflow-hidden">
                    <div class="relative grid gap-6 bg-white dark:bg-dark-bg px-5 py-6 sm:gap-8 sm:p-8">
                      <NuxtLink v-for="item in resources" :key="item.name" :to="item.href"
                        class="-m-3 p-3 flex items-start rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700">
                        <component :is="item.icon" class="flex-shrink-0 h-6 w-6 text-blue-600" aria-hidden="true" />
                        <div class="ml-4">
                          <p class="text-base font-medium text-gray-900 dark:text-MITRE-silver">
                            {{ item.name }}
                          </p>
                          <p class="mt-1 text-sm text-gray-500 dark:text-dark-text">
                            {{ item.description }}
                          </p>
                        </div>
                      </NuxtLink>
                    </div>
                    <div class="px-5 py-5 bg-gray-50 dark:bg-dark-bg sm:px-8 sm:py-8">
                      <div>
                        <h3 class="text-sm tracking-wide font-medium text-gray-500 uppercase">
                          Recent Posts
                        </h3>
                        <ul role="list" class="mt-4 space-y-4">
                          <li v-for="post in recentPosts" :key="post.id" class="text-base truncate">
                            <a :href="post.href"
                              class="font-medium text-gray-900 dark:text-MITRE-silver hover:text-gray-700">
                              {{ post.name }}
                            </a>
                          </li>
                        </ul>
                      </div>
                      <div class="mt-5 text-sm">
                        <a href="#" class="font-medium text-blue-600 hover:text-indigo-500">
                          View all posts <span aria-hidden="true">&rarr;</span></a>
                      </div>
                    </div>
                  </div>
                </PopoverPanel>
              </transition>
            </Popover>
          </PopoverGroup>
          <div class="hidden md:flex items-center justify-end flex-1 pr-2 md:w-0">
            <div class="hidden md:flex items-center justify-end flex-1 md:w-0">
              <!-- Possible Sign in functionalilty -->
              <!-- <a href="#" class="whitespace-nowrap text-base font-medium text-gray-500 hover:text-gray-900 dark:hover:text-gray-200"> Sign in </a>
              <a href="#" class="ml-8 whitespace-nowrap inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-blue-600 hover:bg-indigo-700"> Sign up </a> -->
              <div class="flex-1 flex justify-end px-2 lg:ml-6">
                <div class="max-w-lg w-1/8 lg:max-w-xs">
                  <label for="search" class="sr-only">Search</label>
                  <div class="relative pl-0">
                    <div class="absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none">
                      <SearchIcon class="h-5 w-5 text-gray-400" aria-hidden="true" />
                    </div>
                    <input id="search" name="search"
                      class="block w-0 focus:w-full pl-5 focus:pl-10 pr-4 py-3 border border-transparent rounded-md leading-5 bg-white dark:bg-dark-bg text-gray-300 placeholder-gray-400 focus:outline-none focus:bg-white dark:focus:bg-MITRE-light-silver focus:border-white dark:focus:border-dark-bg focus:ring-blue-400 dark:focus:ring-dark-bg focus:text-gray-900 sm:text-sm hover:bg-gray-200 dark:hover:bg-gray-700"
                      placeholder="Search" type="search" />
                  </div>
                </div>
              </div>
            </div>
            <div id="theme-toggle" type="button" 
              class="text-gray-500 dark:text-dark-text hover:bg-gray-200 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 rounded-lg text-sm p-2.5"
              >
              <div class="relative flex items-center ">
                <SunIcon :class="selected =='Light' ?  'h-6 w-6' : 'hidden'" /> 
                <MoonIcon :class="selected == 'Dark' ?  'h-6 w-6' : 'hidden'" /> 
                <DesktopComputerIcon :class="selected == 'System' ?  'h-6 w-6' : 'hidden'" />
                <select name="theme" id="theme" class="absolute appearance-none pr-3 w-full h-fit opacity-0 dark:bg-slate-600" @change="switchSelect($event)">
                  <option :selected="selected == 'Light'">Light</option>
                  <option :selected="selected == 'Dark'">Dark</option>
                  <option :selected="selected == 'System'">System</option>
                </select >
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Mobile Formatting -->
      <transition enter-active-class="duration-200 ease-out" enter-from-class="opacity-0 scale-95"
        enter-to-class="opacity-100 scale-100" leave-active-class="duration-100 ease-in"
        leave-from-class="opacity-100 scale-100" leave-to-class="opacity-0 scale-95">
        <div class="fixed z-50 top-4 right-4 w-full max-w-xs px-6">  
          <PopoverOverlay class="fixed z-auto inset-0 bg-black/20 backdrop-blur-sm dark:bg-slate-900/80" />
          <PopoverPanel focus class="fixed w-full max-w-xs px-6">
            <div
              class="rounded-lg shadow-lg ring-1 ring-black dark:ring-gray-500 ring-opacity-5 bg-white dark:bg-dark-bg divide-y-2 divide-gray-50">
              <div class="pt-2 pb-4 px-5">
                <div class="flex items-center justify-between">
                  <div class="-mr-2">
                    <PopoverButton
                      class="bg-white dark:bg-dark-bg rounded-md p-2 inline-flex items-center justify-center text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500">
                      <span class="sr-only">Close menu</span>
                      <XIcon class="h-6 w-6" aria-hidden="true" />
                    </PopoverButton>
                  </div>
                </div>
                <div class="my-3">
                  <nav class="grid gap-y-8">
                    <NuxtLink v-for="item in toolkit" :key="item.name" :to="item.href"
                      class="-m-3 p-3 flex items-center rounded-md hover:bg-gray-50 dark:hover:bg-gray-700">
                      <component :is="item.icon" class="flex-shrink-0 h-6 w-6 text-blue-600" aria-hidden="true" />
                      <span class="ml-3 text-base font-medium text-gray-900 dark:text-MITRE-silver">
                        {{ item.name }}
                      </span>
                    </NuxtLink>
                  </nav>
                </div>
              </div>
              <div class="flex items-center justify-between py-6 px-3">
                <label class="text-gray-900 text-base font-medium dark:text-MITRE-silver">Switch Theme</label>
                <div class="relative flex items-center ring-1 ring-slate-900/10 rounded-lg shadow-sm p-2 text-slate-700 font-semibold dark:bg-slate-600 dark:ring-0 dark:highlight-white/5 dark:text-slate-200">
                  <SunIcon :class="selected =='Light' ?  'h-6 w-6' : 'hidden'" /> 
                  <MoonIcon :class="selected == 'Dark' ?  'h-6 w-6' : 'hidden'" /> 
                  <DesktopComputerIcon :class="selected == 'System' ?  'h-6 w-6' : 'hidden'" />
                  <div class="ml-2">{{selected}}</div>
                  <svg class="w-5 h-6  text-slate-400" fill="none"><path d="m15 11-3 3-3-3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                  </svg>
                  <select id="theme" class="absolute appearance-none inset-0 w-full h-full opacity-0 dark:bg-slate-600" @change="switchSelect($event)">
                  <option :selected="selected == 'Light'">Light</option>
                  <option :selected="selected == 'Dark'">Dark</option>
                  <option :selected="selected == 'System'">System</option>
                  </select>
                </div>
              </div>
            </div>
          </PopoverPanel>
        </div>
      </transition>
    </Popover>
    <!-- TODO: Check back later on banner -->
    <!-- <div id="newsBannerDIV" class="relative bg-blue-600">
      <div class="max-w-7xl mx-auto py-3 px-3 sm:px-6 lg:px-8">
        <div class="pr-16 text-center px-16">
          <p class="font-medium text-white">
            <span class="md:hidden"> We have new changes! </span>
            <span class="hidden md:inline">
              Big news! We're excited to announce new changes!
            </span>
            <span class="block ml-2 sm:inline-block">
              <a href="#" class="text-white font-bold underline">
                Learn more <span aria-hidden="true">&rarr;</span></a>
            </span>
          </p>
        </div>
        <div class="absolute inset-y-0 right-0 pt-1 pr-1 flex items-start sm:pt-1 sm:pr-2 sm:items-start">
          <button type="button" id="dismiss-banner-button"
            class="flex p-2 rounded-md hover:bg-indigo-500 focus:outline-none focus:ring-2 focus:ring-white"
            @click="hideBanner()">
            <span class="sr-only">Dismiss</span>
            <XIcon class="h-6 w-6 text-white" aria-hidden="true" />
          </button>
        </div>
      </div>
    </div> -->
  </div>
</template>

<script setup>
import {
  Popover,
  PopoverButton,
  PopoverGroup,
  PopoverPanel,
  PopoverOverlay,
  Switch,
} from '@headlessui/vue';
import { ref } from 'vue';
import {
  BookmarkAltIcon,
  CalendarIcon,
  ChartBarIcon,
  CursorClickIcon,
  MenuIcon,
  PhoneIcon,
  PlayIcon,
  RefreshIcon,
  ShieldCheckIcon,
  SupportIcon,
  ViewGridIcon,
  XIcon,
  CubeIcon,
  ClipboardCheckIcon,
  CodeIcon,
  SearchIcon,
  DotsVerticalIcon,
  DesktopComputerIcon,
  MoonIcon,
  SunIcon,
} from '@heroicons/vue/outline';
import { ChevronDownIcon } from '@heroicons/vue/solid';

const toolkit = [
  {
    name: 'Harden',
    description:
      'Implement security baselines using our Ansible, Chef, and Terraform content.',
    href: '#',
    icon: ShieldCheckIcon
  },
  {
    name: 'Validate',
    description:
      'Generate detailed security testing results through automated tests and manual attestation.',
    href: '#',
    icon: ClipboardCheckIcon
  },
  {
    name: 'Normalize',
    description:
      'Convert security results from all your security tools into a common data format.',
    href: '#',
    icon: CubeIcon
  },
  {
    name: 'Visualize',
    description:
      'Identify overall security status and deep-dive to solve specific security defects',
    href: '#',
    icon: ViewGridIcon
  },
  {
    name: 'Our Tools',
    description:
      'Develop a toolchain to support the above areas of What and How for secure development.',
    href: '#',
    icon: CodeIcon
  }
];
const callsToAction = [
  { name: 'Watch Demo', href: '#', icon: PlayIcon },
  { name: 'Contact Us', href: '#', icon: PhoneIcon }
];
const resources = [
  {
    name: 'Help Center',
    description:
      'Get all of your questions answered in our forums or contact support.',
    href: '/faq',
    icon: SupportIcon
  },
  {
    name: 'Training',
    description:
      'Learn how to maximize our platform to get the most out of it.',
    href: '#',
    icon: BookmarkAltIcon
  },
  {
    name: 'Events',
    description:
      'See what meet-ups and other events we might be planning near you.',
    href: '#',
    icon: CalendarIcon
  }
  // { name: 'Security', description: 'Understand how we take your privacy seriously.', href: '#', icon: ShieldCheckIcon },
];
const recentPosts = [
  { id: 1, name: 'Boost your conversion rate', href: '#' },
  {
    id: 2,
    name: 'How to use search engine optimization to drive traffic to your site',
    href: '#'
  },
  { id: 3, name: 'Improve your customer experience', href: '#' }
];
const enabled = ref(true);

</script>
<script>
export default {
  data() {
    return {
      selected: "",
      options: ['Light', 'Dark', 'System'],
    };
  },
  methods: {
    switchSelect(event) {
      console.log("switchSelect: ", event.target.value);
      if (event.target.value === 'Light') {
        this.disableDarkMode()
        localStorage.setItem('user-theme', 'light');
        this.selected = "Light"
        this.setThemeState(this.selected)
      }
      else if (event.target.value == 'Dark'){
        this.enableDarkMode()
        localStorage.setItem('user-theme', 'dark');
        this.selected = "Dark"
        this.setThemeState(this.selected)
      }
      //TODO: Handle system option
      else if (event.target.value == 'System')
      {
        const userIsInDarkModeOS = window.matchMedia('(prefers-color-scheme: dark)').matches
        if (userIsInDarkModeOS) {
          this.enableDarkMode()
          localStorage.setItem('user-theme', 'dark');
          this.selected = "System";
          this.setThemeState(this.selected) 
        }
        else {
          this.disableDarkMode()
          this.selected = "System";
        }
      }
    },
    setThemeState(mode){
      localStorage.setItem('theme', mode)
    },
    getThemeState(){
      let theme = localStorage.getItem('theme')
      this.selected = theme
    },
    enableDarkMode() {
      document.documentElement.classList.add('dark');
    },
    disableDarkMode() {
      document.documentElement.classList.remove('dark');
    },
    hideBanner() {
      var bannerDIV = document.getElementById("newsBannerDIV")
      bannerDIV.style.display = "none"
    },
  },
  mounted() {
    
    this.getThemeState()

    if (this.selected === 'Light') {
      this.disableDarkMode()
      localStorage.setItem('user-theme', 'light');
      this.selected = "Light"
      this.setThemeState(this.selected)
    }
    else if (this.selected == 'Dark'){
      this.enableDarkMode()
      localStorage.setItem('user-theme', 'dark');
      this.selected = "Dark"
      this.setThemeState(this.selected)
    }
    else if (this.selected == 'System')
    {
      const userIsInDarkModeOS = window.matchMedia('(prefers-color-scheme: dark)').matches
      if (userIsInDarkModeOS) {
        this.enableDarkMode()
        localStorage.setItem('user-theme', 'dark')
        this.selected = "System"
        this.setThemeState(this.selected) 
      }
      else {
        this.disableDarkMode()
        this.selected = "System";
      }
    }
  }
  
};
</script>